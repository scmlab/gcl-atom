// Generated by BUCKLESCRIPT, PLEASE EDIT WITH CARE
'use strict';

var Curry = require("bs-platform/lib/js/curry.js");
var Json_decode = require("@glennsl/bs-json/lib/js/src/Json_decode.bs.js");
var Body$GclAtom = require("./View/Body.bs.js");
var Expr$GclAtom = require("./View/Expr.bs.js");
var Type$GclAtom = require("./View/Type.bs.js");
var Decoder$GclAtom = require("./Decoder.bs.js");
var Caml_chrome_debugger = require("bs-platform/lib/js/caml_chrome_debugger.js");

var decode = Decoder$GclAtom.sum((function (tag) {
        switch (tag) {
          case "NotFunction" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (param) {
                                          return /* NotFunction */Caml_chrome_debugger.variant("NotFunction", 3, [param[0]]);
                                        }), (function (param) {
                                          return Json_decode.pair(Type$GclAtom.decode, Decoder$GclAtom.range, param);
                                        }), param);
                          })]);
          case "NotInScope" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (param) {
                                          return /* NotInScope */Caml_chrome_debugger.variant("NotInScope", 0, [param[0]]);
                                        }), (function (param) {
                                          return Json_decode.pair(Json_decode.string, Decoder$GclAtom.range, param);
                                        }), param);
                          })]);
          case "RecursiveType" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (param) {
                                          return /* RecursiveType */Caml_chrome_debugger.variant("RecursiveType", 2, [
                                                    param[0],
                                                    param[1]
                                                  ]);
                                        }), (function (param) {
                                          return Json_decode.tuple3(Json_decode.$$int, Type$GclAtom.decode, Decoder$GclAtom.range, param);
                                        }), param);
                          })]);
          case "UnifyFailed" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (param) {
                                          return /* UnifyFailed */Caml_chrome_debugger.variant("UnifyFailed", 1, [
                                                    param[0],
                                                    param[1]
                                                  ]);
                                        }), (function (param) {
                                          return Json_decode.tuple3(Type$GclAtom.decode, Type$GclAtom.decode, Decoder$GclAtom.range, param);
                                        }), param);
                          })]);
          default:
            throw [
                  Json_decode.DecodeError,
                  "Unknown constructor: " + tag
                ];
        }
      }));

var $$TypeError = {
  decode: decode
};

var decode$1 = Decoder$GclAtom.sum((function (tag) {
        switch (tag) {
          case "DigHole" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return /* DigHole */4;
                          })]);
          case "ExcessBound" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return /* ExcessBound */2;
                          })]);
          case "MissingAssertion" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return /* MissingAssertion */1;
                          })]);
          case "MissingBound" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return /* MissingBound */0;
                          })]);
          case "MissingPostcondition" :
              return /* TagOnly */Caml_chrome_debugger.variant("TagOnly", 1, [(function (param) {
                            return /* MissingPostcondition */3;
                          })]);
          case "Panic" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (json) {
                            return /* Panic */Caml_chrome_debugger.simpleVariant("Panic", [Json_decode.string(json)]);
                          })]);
          default:
            throw [
                  Json_decode.DecodeError,
                  "Unknown constructor: " + tag
                ];
        }
      }));

var ConvertError = {
  decode: decode$1
};

var decode$2 = Decoder$GclAtom.sum((function (tag) {
        switch (tag) {
          case "Global" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (json) {
                            return /* Global */Caml_chrome_debugger.variant("Global", 0, [Decoder$GclAtom.range(json)]);
                          })]);
          case "Local" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (param) {
                                          return /* Local */Caml_chrome_debugger.variant("Local", 1, [
                                                    param[0],
                                                    param[1]
                                                  ]);
                                        }), (function (param) {
                                          return Json_decode.pair(Decoder$GclAtom.range, Json_decode.$$int, param);
                                        }), param);
                          })]);
          default:
            throw [
                  Json_decode.DecodeError,
                  "Unknown constructor: " + tag
                ];
        }
      }));

function toRange(param) {
  return param[0];
}

function toString(site) {
  var rangeToString = function (range) {
    return String(range.start.row) + (":" + (String(range.start.column) + ("-" + (String(range.end.row) + (":" + String(range.end.column))))));
  };
  if (site.tag) {
    return "at " + (rangeToString(site[0]) + (" in #" + String(site[1])));
  } else {
    return "at " + rangeToString(site[0]);
  }
}

var Site = {
  decode: decode$2,
  toRange: toRange,
  toString: toString
};

var decodeKind = Decoder$GclAtom.sum((function (tag) {
        switch (tag) {
          case "ConvertError" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (json) {
                            return /* ConvertError */Caml_chrome_debugger.variant("ConvertError", 1, [Curry._1(decode$1, json)]);
                          })]);
          case "LexicalError" :
              return /* TagOnly */Caml_chrome_debugger.variant("TagOnly", 1, [(function (param) {
                            return /* LexicalError */0;
                          })]);
          case "SyntacticError" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (param) {
                                          return /* SyntacticError */Caml_chrome_debugger.variant("SyntacticError", 0, [param[1]]);
                                        }), (function (param) {
                                          return Json_decode.pair(Decoder$GclAtom.range, Json_decode.string, param);
                                        }), param);
                          })]);
          case "TypeError" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (json) {
                            return /* TypeError */Caml_chrome_debugger.variant("TypeError", 2, [Curry._1(decode, json)]);
                          })]);
          default:
            throw [
                  Json_decode.DecodeError,
                  "Unknown constructor: " + tag
                ];
        }
      }));

function decode$3(param) {
  return Json_decode.map((function (param) {
                return /* Error */Caml_chrome_debugger.simpleVariant("Error", [
                          param[0],
                          param[1]
                        ]);
              }), (function (param) {
                return Json_decode.pair(decode$2, decodeKind, param);
              }), param);
}

var $$Error = {
  TypeError: $$TypeError,
  ConvertError: ConvertError,
  Site: Site,
  decodeKind: decodeKind,
  decode: decode$3
};

function decodeHardness(param) {
  return Json_decode.map((function (tag) {
                switch (tag) {
                  case "Hard" :
                      return /* Hard */0;
                  case "Soft" :
                      return /* Soft */1;
                  default:
                    throw [
                          Json_decode.DecodeError,
                          "Unknown constructor: " + tag
                        ];
                }
              }), Json_decode.string, param);
}

function decode$4(json) {
  return /* record */Caml_chrome_debugger.record([
            "id",
            "hardness",
            "pre",
            "post",
            "range"
          ], [
            Json_decode.field("specID", Json_decode.$$int, json),
            Json_decode.field("specHardness", decodeHardness, json),
            Json_decode.field("specPreCond", Expr$GclAtom.decode, json),
            Json_decode.field("specPostCond", Expr$GclAtom.decode, json),
            Json_decode.field("specLoc", Decoder$GclAtom.range, json)
          ]);
}

var Specification = {
  decodeHardness: decodeHardness,
  decode: decode$4
};

var decode$5 = Decoder$GclAtom.sum((function (tag) {
        switch (tag) {
          case "Error" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (errors) {
                                          return /* Error */Caml_chrome_debugger.variant("Error", 0, [errors]);
                                        }), (function (param) {
                                          return Json_decode.array(decode$3, param);
                                        }), param);
                          })]);
          case "OK" :
              var partial_arg = Body$GclAtom.ProofObligation.decode;
              var partial_arg$1 = function (param) {
                return Json_decode.array(partial_arg, param);
              };
              var partial_arg$2 = function (param) {
                return Json_decode.pair(partial_arg$1, (function (param) {
                              return Json_decode.array(decode$4, param);
                            }), param);
              };
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (param) {
                                          return /* OK */Caml_chrome_debugger.variant("OK", 1, [
                                                    param[0],
                                                    param[1]
                                                  ]);
                                        }), partial_arg$2, param);
                          })]);
          case "Resolve" :
              return /* Contents */Caml_chrome_debugger.variant("Contents", 0, [(function (param) {
                            return Json_decode.map((function (i) {
                                          return /* Resolve */Caml_chrome_debugger.variant("Resolve", 2, [i]);
                                        }), Json_decode.$$int, param);
                          })]);
          default:
            throw [
                  Json_decode.DecodeError,
                  "Unknown constructor: " + tag
                ];
        }
      }));

exports.$$Error = $$Error;
exports.Specification = Specification;
exports.decode = decode$5;
/* decode Not a pure module */
